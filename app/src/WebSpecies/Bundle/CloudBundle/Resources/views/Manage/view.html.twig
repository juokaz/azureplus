{% extends '::base.html.twig' %}

{% set database = entity.getDatabases.0 %}

{% block content %}
<div class="page-header">
    <h2><a href="{{ path('CloudBundle_manage') }}">&larr; MyApps</a> <span class="divider">/</span> {{ entity.getUrl }}</h2>
</div>
        
<div class="row">
  <div class="span9">
      <h3>Deployments</h3>
      {% if entity.isAutoDeployable %}
      <p>Your app is auto-updated from the GIT repository, no further actions needed! It usually takes about one to two minutes for new commits to be deployed.</p>

      <p style="font-size: 12px"><span class="label important">Important</span><br /> You can make the app accept direct deployments by clearing the Git repository location.</p>
      {% else %}
      <p>You can push new code you want using <a href="{{ path('CloudBundle_deploy_script', {'name': entity.getName}) }}">this</a> simple script, just run <code>php deploy.php</code> from your project folder. The live instance is going to start working with the new code in less than a minute!</p>

      <p style="font-size: 12px"><span class="label important">Important</span><br /> You can make the app auto update deployments by entering the Git repository location.</p>
      {% endif %}

      <h3>Database</h3>

      <p>To connect to the database from your app use code like:</p>

      <pre>
$conn = new PDO("sqlsrv:Server={{ database.getDnsName }}", "{{ database.getUser }}@{{ database.getName }}", "{{ database.getPassword }}");
</pre>

      <p>or</p>

      <pre>
$serverName = "tcp:{{ database.getDnsName }},1433";
$userName = '{{ database.getUser }}@{{ database.getName }}';
$userPassword = '{{ database.getPassword }}';

$connectionInfo = array("UID"=>$userName, "PWD"=>$userPassword);

$conn = sqlsrv_connect($serverName, $connectionInfo);
</pre>
  </div>

  <div class="span5">
    <form action="" method="post" novalidate {{ form_enctype(form) }} class="form-stacked">
        <fieldset>
            <legend>Edit</legend>
            {{ form_widget(form) }}
            <div class="actions">
                <input type="submit" value="{{ 'Save'|trans }}" class="btn primary">
            </div>
        </fieldset>
    </form>
  </div>
</div>

{% endblock %}
